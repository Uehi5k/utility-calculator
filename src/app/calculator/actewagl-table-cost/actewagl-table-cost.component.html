<h3>
  Total {{ numberOfDays() }} @if (numberOfDays() > 1) { days } @else { day }
</h3>
<p>
  Period <strong>{{ fromDate() }}</strong> to <strong>{{ toDate() }}</strong>
</p>
<div class="alert alert-info">
  <p>
    For <strong>Self Consumption</strong> - typically this is the amount of
    usage from Solar during daytime, and normally Solar starts generating power
    around 9am, I assume the rate will be the same as
    <strong>Shoulder</strong> type. Though, the input is allowed to be modified
    so feel free to fill in the data required.
  </p>
  <p>
    We will use info about Self Consumption and treated as if it's from the Grid
    to know how much you have saved in regard of Solar export.
  </p>
  <p>
    <strong>How to know Self Consumption</strong> - if you are using an app to
    track your Solar usage, you can select which periods and see how much you
    use during that period of time.
  </p>
</div>

<table class="table table-striped">
  <thead>
    <tr>
      <th scope="col">Usage Type</th>
      <th scope="col">Rate</th>
      <th scope="col">Quantity</th>
      <th scope="col">GST</th>
      <th scope="col">Total</th>
    </tr>
  </thead>
  <tbody>
    @if (totalSupplyCharge() > 0) {
    <tr>
      <td><strong>Daily Supply Charge</strong></td>
      <td>
        {{ supplyChargeRate() | currency : "AUD" }}
      </td>
      <td>{{ numberOfDays() }} {{ numberOfDays() > 1 ? "days" : "day" }}</td>
      <td>
        {{
          supplyChargeRate() * numberOfDays() * supplyChargeRateGst()
            | currency : "AUD"
        }}
      </td>
      <td>
        {{ totalSupplyCharge() | currency : "AUD" }}
      </td>
    </tr>
    } @for (actewAGLCost of listOfTotalActewAGLCost(); track
    actewAGLCost.usageType) {
    <tr>
      <td>
        <strong>{{ actewAGLCost.usageType }}</strong>
        <br />{{ actewAGLCost.hours }}
      </td>
      <td>
        <div class="input-group input-group-sm number-input">
          <span
            class="input-group-text"
            [id]="'rate-usage' + actewAGLCost.usageType"
            >A$</span
          >
          <input
            type="number"
            class="form-control"
            aria-label="Rate"
            [attr.aria-describedby]="'rate-usage' + actewAGLCost.usageType"
            [ngModel]="actewAGLCost.rate"
            (ngModelChange)="updateUsageTypeRate(actewAGLCost, $event)"
          />
        </div>
      </td>
      <td>
        <div class="input-group input-group-sm number-input">
          <input
            type="number"
            class="form-control"
            aria-label="Quantity"
            [attr.aria-describedby]="'quantity-usage' + actewAGLCost.usageType"
            [ngModel]="actewAGLCost.quantity"
            (ngModelChange)="updateUsageTypeQuantity(actewAGLCost, $event)"
          />
          <span
            class="input-group-text"
            [id]="'quantity-usage' + actewAGLCost.usageType"
            >kWh</span
          >
        </div>
      </td>
      <td>
        {{
          actewAGLCost.gst * actewAGLCost.rate * actewAGLCost.quantity
            | currency : "AUD"
        }}
      </td>
      <td
        [ngClass]="{
          'bg-success': actewAGLCost.total < 0,
          'text-light': actewAGLCost.total < 0
        }"
      >
        {{ actewAGLCost.total | currency : "AUD" }}
      </td>
    </tr>
    }
    <tr>
      <td colspan="4" class="text-end">
        <strong
          >Total
          {{ totalIncludingSupply() < 0 ? "saving" : "cost" }}
          @if (costReduction() > 0) { ({{
            costReduction() | percent
          }}
          reduction) }</strong
        >
      </td>
      <td
        [ngClass]="{
          'bg-success': totalIncludingSupply() < 0,
          'bg-danger': totalIncludingSupply() > 0,
          'text-light': true
        }"
      >
        <strong>{{ totalIncludingSupply() | currency : "AUD" }}</strong>
      </td>
    </tr>
    <tr>
      <td colspan="4" class="text-end">
        <strong>Total without Solar System</strong>
      </td>
      <td
        [ngClass]="{
          'bg-success': totalIncludingSupplyChargeWithoutSolarSystem() < 0,
          'bg-danger': totalIncludingSupplyChargeWithoutSolarSystem() > 0,
          'text-light': true
        }"
      >
        <strong>{{
          totalIncludingSupplyChargeWithoutSolarSystem() | currency : "AUD"
        }}</strong>
      </td>
    </tr>
  </tbody>
</table>
